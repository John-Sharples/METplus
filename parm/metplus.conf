## This is a UNIX conf file that contains all information relating to
# the METplus configuration.  UNIX conf is used because of how easy it is
# to parse (even GrADS can do it).  The syntax:
#
#      [section]
#      var = value
#
# For generation of namelists for WRF, WPS and other Fortran programs,
# we use this syntax:
#
#     [section]
#     namelist.nlvar = value
#
# to set the value of namelist &namelist's nlvar variable.  Also, the
# special variable "namelist" lists additional conf sections to
# recurse into to get more namelist variables after the current conf
# section is parsed.  Any variable will only be set once: the first
# time it is seen.

## Sets basic configuration options used by all components.
#
# This section sets basic configuration options used by all components.  
# Several special variables in this section are set by the ProdConfig 
# object itself, which will overwrite them if they're set in this
# file:
# * YMDHM = analysis time (201304261830 = April 26, 2013, 18:30 UTC)
# * YMDH = analysis time excluding minute (2013042618)
# * YMD = analysis time, excluding hour and minute
# * year, YYYY = analysis time's year (ie.: 2013)
# * YY = last two digits of year
# * century, CC = first two digits of year
# * month, MM = analysis time's month (ie.: 04)
# * day, DD = analysis time's day (ie.: 26)
# * hour, cyc, HH = analysis time's hour (ie.: 18)
# * minute, min = analysis time's minute (ie.: 30)
#
# There may be additional variables depending on what subclass (if
# any) of the ProdConfig is used.  You must specify the mandatory EXPT
# value, which is the name of the experiment to run.

[version]
#
#   VERSION NUMBERS GO HERE
#
MET_VERSION = 5.2


[dir]
# Commonly used base METplus variables
METPLUS_BASE = /d1/SBU_util      ;; METplus installation location
PARM_BASE = {METPLUS_BASE}/parm  ;; METplus parm directory location
OUTPUT_BASE = /d1/SBU_util/out

#METPLUS_BASE = {ENV[METPLUS_BASE]}      ;; METplus installation location

# Commonly used base MET variables
MET_BUILD_BASE = /d1/CODE/MET/MET_releases/met-5.2
MET_BASE = {MET_BUILD_BASE}/share/met
MET_BIN = {MET_BUILD_BASE}/bin           ;; Required by Rscript call Used by TCMPRPlotter.py


# Input data directories
PROJ_DIR = /d1/SBU/GFS
GFS_DIR = {PROJ_DIR}/model_data
TRACK_DATA_DIR = {PROJ_DIR}/track_data

# Output directories
LOG_DIR = {OUTPUT_BASE}/logs
OUT_DIR = {OUTPUT_BASE}/series_analysis
TMP_DIR = /tmp
TRACK_DATA_SUBDIR_MOD = {PROJ_DIR}/track_data_atcf
TC_PAIRS_DIR = {PROJ_DIR}/tc_pairs
TC_STAT_DIR = {PROJ_DIR}/tc_stat
TCMPR_PLOT_OUT_DIR = {OUTPUT_BASE}/tcmpr_plots

# Use this setting to separate the filtered track files from
# the series analysis directory.
EXTRACT_OUT_DIR = {OUTPUT_BASE}/extract_tiles
SERIES_LEAD_FILTERED_OUT_DIR = {OUTPUT_BASE}/series_lead_filtered
SERIES_INIT_FILTERED_OUT_DIR = {OUTPUT_BASE}/series_init_filtered

# Define the output directories for Series analysis by lead and init
SERIES_LEAD_OUT_DIR = {OUTPUT_BASE}/series_analysis_lead
SERIES_INIT_OUT_DIR = {OUTPUT_BASE}/series_analysis_init

# SBU CONVERSION
SBU_OUTPUT_DIR = {OUTPUT_BASE}/cyclone_relative

## Executable program locations
[exe]
# NON-MET executables
WGRIB2 = /d1/CODE/wgrib2
RM_EXE = /bin/rm
CUT_EXE = /usr/bin/cut
TR_EXE = /usr/bin/tr
NCAP2_EXE =/usr/local/nco/bin/ncap2
CONVERT_EXE =/usr/bin/convert
NCDUMP_EXE = /usr/local/bin/ncdump
EGREP_EXE = /bin/egrep

# MET Executables
TC_STAT = {MET_BUILD_BASE}/bin/tc_stat
SERIES_ANALYSIS = {MET_BUILD_BASE}/bin/series_analysis
PLOT_DATA_PLANE = {MET_BUILD_BASE}/bin/plot_data_plane
TC_PAIRS = {MET_BUILD_BASE}/bin/tc_pairs
REGRID_DATA_PLANE_EXE = {MET_BUILD_BASE}/bin/regrid_data_plane
PLOT_TCMPR = {MET_BUILD_BASE}/scripts/Rscripts/plot_tcmpr.R

## Filename Templates
[filename_templates]
# We DO NOT want to interpret time info or expand{} these values.
# Use, getraw('filename_templates','GFS_FCST_FILE_TMPL') to get
# 'gfs_4_{init?fmt=%Y%m%d}_{init?fmt=%H}00_{lead?fmt=%HHH}.grb2'
GFS_FCST_FILE_TMPL = gfs_4_{init?fmt=%Y%m%d}_{init?fmt=%H}00_{lead?fmt=%HHH}.grb2
GFS_FCST_NC_FILE_TMPL = gfs_4_{init?fmt=%Y%m%d}_{init?fmt=%H}00_{lead?fmt=%HHH}.nc
GFS_ANLY_FILE_TMPL = gfs_4_{valid?fmt=%Y%m%d}_{valid?fmt=%H}00_000.grb2
GFS_ANLY_NC_FILE_TMPL = gfs_4_{valid?fmt=%Y%m%d}_{valid?fmt=%H}00_000.nc

## Regex patterns
[regex_pattern]
# Regular expressions that are used in series analysis
# Forecast and Analysis tile files, and ASCII files
# created by the series analysis by init and lead time
FCST_TILE_PREFIX = FCST_TILE_F
ANLY_TILE_PREFIX = ANLY_TILE_F

FCST_TILE_REGEX = .*FCST_TILE_F.*.grb2
ANLY_TILE_REGEX = .*ANLY_TILE_F.*.grb2
FCST_NC_TILE_REGEX = .*FCST_TILE_F.*.nc
ANLY_NC_TILE_REGEX = .*ANLY_TILE_F.*.nc

ANLY_TILE_REGEX = .*ANLY_TILE_F.*.grb2

FCST_ASCII_REGEX_INIT = FCST_ASCII_FILE.*
ANLY_ASCII_REGEX_INIT = ANLY_ASCII_FILE.*
FCST_ASCII_REGEX_LEAD = FCST_FILE_F.*
ANLY_ASCII_REGEX_LEAD = ANLY_FILE_F.*

[config]

EXPT=METplus ;; Experiment name, used for finding installation locations

# jtf? Should we add a flag to set MET_BASE in the environment, 
# This was in the original constants file, os.environ["MET_BASE"] = MET_BASE
# it is now being set in each process
# set_MET_BASE=yes

# Configuration files
# _PATH  in the names below is deceiving ... since these are config files 
TC_PAIRS_CONFIG_PATH = {PARM_BASE}/TCPairsETCConfig
SERIES_ANALYSIS_BY_LEAD_CONFIG_PATH = {PARM_BASE}/SeriesAnalysisConfig_by_lead
SERIES_ANALYSIS_BY_INIT_CONFIG_PATH = {PARM_BASE}/SeriesAnalysisConfig_by_init
TCMPR_PLOT_CONFIG =

# Processes to run in master script (master_met_plus.py)
#PROCESS_LIST = run_tc_pairs.py, extract_tiles.py, series_by_lead.py, series_by_init.py
PROCESS_LIST = run_tc_pairs.py, extract_tiles.py, series_by_lead.py

# NOTE: "TOTAL" is a REQUIRED cnt statistic used by the series analysis scripts
STAT_LIST = TOTAL, FBAR, OBAR, ME, MAE, RMSE, BCMSE, E50, EIQR, MAD

INIT_DATE_BEG = 20141201  ;; DATE must be in YYYYMMDD format
INIT_DATE_END = 20150331
INIT_HOUR_INC =  6 ;; The increment in integer format
INIT_HOUR_END = 18 ;; Should be a string in HH or HHH format

# Used by extract_tiles.py to define the records of interest from the grib2 file
VAR_LIST = HGT/P500, PRMSL/Z0, TMP/Z2, PWAT/L0, HGT/P250, TMP/P850, TMP/P500, UGRD/P250, VGRD/P250
# if = <nothing> initializes to an empty string '' or list [], if getlist is called.
EXTRACT_TILES_VAR_LIST = 

# Used for performing series analysis based on lead time
FHR_BEG = 0
FHR_END = 138 
FHR_INC = 6

# Constants used in creating the tile grid
NLAT = 60
NLON = 60

# Resolution of data in degrees
DLAT = 0.5
DLON = 0.5

# Degrees to subtract from the center lat and lon to 
# calculate the lower left lat (lat_ll) and lower
# left lon (lon_ll) for a grid that is 2n X 2m, 
# where n = LAT_ADJ degrees and m = LON_ADJ degrees.
# For this case, where n=15 and m=15, this results
# in a 30 deg X 30 deg grid.
LON_ADJ = 15
LAT_ADJ = 15

# TC PAIRS filtering options
TRACK_TYPE = extra_tropical_cyclone
ADECK_FILE_PREFIX = amlq
BDECK_FILE_PREFIX = bmlq
MISSING_VAL_TO_REPLACE = -99
MISSING_VAL = -9999

# TC-STAT filtering options
EXTRACT_TILES_FILTER_OPTS = -basin ML -out_init_mask {MET_BUILD_BASE}/share/met/poly/CONUS.poly
SERIES_ANALYSIS_FILTER_OPTS = -init_beg {INIT_DATE_BEG} -init_end {INIT_DATE_END}

# OVERWRITE OPTIONS
# Don't overwrite filter files if they already exist.
# Set to no if you do NOT want to override existing files
# Set to yes if you do want to override existing files
OVERWRITE_TRACK = no 
TRACK_DATA_MOD_FORCE_OVERWRITE = no
TC_PAIRS_FORCE_OVERWRITE = no

# PLOTTING
# By default, background map is turned off. Set 
# to no to turn of plotting of background map.
BACKGROUND_MAP = no

# REGRDDING
# ALWAYS set this to yes.  This will use 
# the MET Tool regrid_data_plane to perform all regridding.
REGRID_USING_MET_TOOL = yes

# LOGGING
LOG_LEVEL = INFO ;; Levels: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_FILENAME = {LOG_DIR}/master_met_plus.log ;; NOTE: current YYYYMMDD is inserted before the rightmost . filename extension

# SBU CONVERSION
SBU_OUTPUT_DIR = {OUTPUT_BASE}/cyclone_relative

# LON format example: -180 is 180W, 40 is 40E
SBU_WEST_MOST_LON = -180.0
SBU_EAST_MOST_LON = 40.0
SBU_SOUTHERN_MOST_LAT = 0
SBU_NORTHERN_MOST_LAT = 90.0

# The resolution in decimal degrees
SBU_DLAT = 0.5
SBU_DLON = 0.5

# Final conf file used by all processes.
METPLUS_CONF={OUTPUT_BASE}/metplus_final.conf

# These are currently not used.
# Enable or disable parts of the workflow
run_tc_pairs=yes          ;;
run_extract_tiles=yes     ;; Extract Tiles
run_series_by_lead=yes    ;;
run_series_by_init=yes    ;;

# TCMPR Input data, This can be a directory that contains the input data
# or it can be a specific file.
TCMPR_DATA = {TC_PAIRS_DIR}

# Plot_TCMPR options, if left unset, default values pre-defined in R utility will be used.
CONFIG_FILE = 
PREFIX =
TITLE =
SUBTITLE = 
XLAB = 
YLAB = 
XLIM = 
YLIM = 
FILTER = 
FILTERED_TCST_DATA_FILE = 
DEP_VARS = 
SCATTER_X = 
SCATTER_Y = 
SKILL_REF = 
SERIES = 
SERIES_CI = 
LEGEND = 
LEAD = 
PLOT_TYPES = MEAN,MEDIAN 
RP_DIFF = 
DEMO_YR = 
HFIP_BASELINE = 
FOOTNOTE_FLAG = 
PLOT_CONFIG_OPTS = 
SAVE_DATA = 

# TCMPR FLAGS no == (don't set flag), yes == (set flag)
NO_EE = no
NO_LOG = no
SAVE = no

